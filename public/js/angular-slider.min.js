/*! angular-slider 2014-01-21 */
angular.module("vr.directives.slider",["ngTouch"]).directive("slider",["$timeout","$document","$interpolate","$swipe",function(a,b,c,d){var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t;return r=3,s=c.startSymbol(),t=c.endSymbol(),e=function(a){return angular.element(a)},l=function(a){return""+a+"px"},i=function(a){return a.css({opacity:0})},p=function(a){return a.css({opacity:1})},j=function(a,b){return a.css({left:b})},h=function(a){return q(a)/2},k=function(a){try{return a.offset().left}catch(b){}return a[0].getBoundingClientRect().left},q=function(a){var b=parseFloat(a.css("width"));return isNaN(b)?a[0].offsetWidth:b},g=function(a,b){return k(b)-k(a)-q(a)},f=function(a,b){return a.attr("ng-bind-template",b)},m=function(a,b,c,d,e){var f,g,h,i;return(null==c||0==c)&&(c=1/Math.pow(10,b)),null==d&&(d=0),(null==a||isNaN(a))&&(a=0),g=(a-d)%c,i=g>c/2?a+c-g:a-g,f=Math.pow(10,b),h=i*f/f,null==e&&(e=h),h=d>h?d:h>e?e:h,parseFloat(h.toFixed(b))},n=function(a,b){return a>0&&!isNaN(b)?Math.ceil(b/a)*a:b},o=function(a){return s+" "+a+" "+t},{restrict:"EA",scope:{floor:"@",ceiling:"@",step:"@",precision:"@",buffer:"@",stretch:"@",ngModel:"=",ngModelLow:"=",ngModelHigh:"=",translate:"&"},template:"<span class='bar full'></span><span class='bar selection'></span><span class='bar unselected low'></span><span class='bar unselected high'></span><span class='pointer low'></span><span class='pointer high'></span><span class='bubble low'></span><span class='bubble high'></span><span class='bubble middle'></span><span class='bubble selection'></span><span class='bubble limit floor'></span><span class='bubble limit ceiling'></span><input type='range' class='input low' /><input type='range' class='input high' /><input type='range' class='input selection' />",compile:function(c,s){var t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S;if(s.translate&&s.$set("translate",""+s.translate+"(value)"),C=null==s.ngModel&&null!=s.ngModelLow&&null!=s.ngModelHigh,D=Modernizr.inputtypes.range||!1,R=function(){var a,b,d,f;for(d=c.children(),f=[],a=0,b=d.length;b>a;a++)v=d[a],v=e(v),v.css({"white-space":"nowrap",position:"absolute",display:"block","z-index":1}),f.push(v);return f}(),x=R[0],H=R[1],I=R[2],J=R[3],B=R[4],A=R[5],z=R[6],y=R[7],u=R[8],K=R[9],w=R[10],t=R[11],L=R[12],M=R[13],N=R[14],x.css({left:0,right:0}),F=C?"ngModelLow":"ngModel",E="ngModelHigh",G="selectBar",D){var T={position:"absolute",margin:0,padding:0,opacity:0,height:"100%"};L.attr("step",o("inputSteps()")),L.attr("min",o("floor")),L.css(T),L.css("left",0),C?(L.attr("max",o("ngModelHigh - (buffer / 2)")),M.attr("step",o("inputSteps()")),M.attr("min",o("ngModelLow + (buffer / 2)")),M.attr("max",o("ceiling")),M.css(T),N.attr("step",o("inputSteps()")),N.attr("min",o("ngModelLow")),N.attr("max",o("ngModelHigh")),N.css(T)):(L.attr("max",o("ceiling")),L.css({width:"100%"}),M.remove(),N.remove())}else L.remove(),M.remove(),N.remove();if(f(t,o("translation(ceiling)")),f(w,o("translation(floor)")),f(K,"Range: "+o("translation(diff)")),f(z,o("translation("+F+")")),f(y,o("translation("+E+")")),f(u,o("translation("+F+")")+" - "+o("translation("+E+")")),!C)for(S=[H,I,J,A,K,y,u],P=0,Q=S.length;Q>P;P++)c=S[P],c.remove();return O=[F,"floor","ceiling"],C&&(O.push(E),O.push("buffer")),{post:function(c,e,f){c.translation=function(a){return a=parseFloat(a).toFixed(c.precision),angular.isUndefined(f.translate)?""+a:c.translate({value:a})},c.inputSteps=function(){return Math.pow(10,-1*c.precision)};var o,s,v,P,Q,R,S,T,U,V,W,X,Y,Z,$=0,_=0;for(s=!1,U=o=R=P=S=Q=W=T=void 0,v=function(){var a,b,d,e;for(angular.isUndefined(c.precision)&&(c.precision=0),angular.isUndefined(c.step)&&(c.step=0),c.buffer=e=n(parseFloat(c.step),parseFloat(c.buffer)),c.floor=parseFloat(c.floor),c.ceiling=parseFloat(c.ceiling),b=0,d=O.length;d>b;b++)a=O[b],(a==F||a==E)&&(c[a]=m(parseFloat(c[a]),parseFloat(c.precision),parseFloat(c.step),parseFloat(c.floor),parseFloat(c.ceiling)));if(C&&parseFloat(c[E])<parseFloat(c[F])){var g=c[E];c[E]=c[F],c[F]=g}if(C&&(c.diff=m(c[E]-c[F],parseFloat(c.precision),parseFloat(c.step)),e>0&&c.diff<e)){var i=(parseFloat(c[F])+parseFloat(c[E]))/2;c[F]=m(i-e/2,parseFloat(c.precision),parseFloat(c.step),parseFloat(c.floor),parseFloat(c.ceiling)),c[E]=parseFloat(c[F])+e,c[E]>c.ceiling&&(c[F]-=e,c[E]=c.ceiling),c.diff=e}return U=h(B),o=q(x),R=k(x),P=R+o-q(B),S=parseFloat(f.floor),Q=parseFloat(f.ceiling),W=Q-S,T=P-R},V=function(){var a,f,O,Q,V,X,Y,Z,ab,bb,cb,db,eb,fb,gb,hb,ib,jb,kb;v(),j(w,0),j(t,l(o-q(t))),O=function(a){return 100*((a-R)/T)},Q=function(a){return(a-S)/W*T+R},X=function(a){return 100*((a-S)/W)},V=function(a){return l(a*T/100)},f=function(a){return j(a,V(O(Math.min(Math.max(R,k(a)),P))))},ab=function(a,b,d){var e=a>0?1:-1;if(b=0==b?100:b,d)return(Math.sin(Math.min(Math.abs(a/b),1)*Math.PI-Math.PI/2)+1)*e*b/6;var f=parseInt(c.stretch)||r;return e*Math.pow(Math.min(Math.abs(2*(a/b)),1),f)*b/2},Z=function(){var a,b,d,e,f,g,i;if(f=X(parseFloat(c.step)+S),g=X(n(parseFloat(c.step),parseFloat(c.buffer))+S),b=X(c[F]),d=b+ab($,f),j(B,V(d)),j(z,V(O(k(B)-h(z)+U))),C&&(a=X(c[E]),d>a-g&&(d=b+ab($,g,!0),j(B,V(d)),j(z,V(O(k(B)-h(z)+U)))),e=a+ab(_,f),b+g>e&&(e=a+ab(_,g,!0)),j(A,V(e)),j(y,V(O(k(A)-h(y)+U))),i=O(U+R),j(H,V(d+i)),H.css({width:V(e-d)}),N.css({left:V(d+2*i),width:V(e-d-2*i)}),I.css({left:0,width:V(d+i)}),j(J,V(e+i)),J.css({right:0}),j(K,V(d+O(h(H)-h(K)+R))),j(u,V(d+O(h(H)-h(u)+R))),D)){L.css({width:e-g/2+"%"});var l=d+g/2;M.css({left:l+"%",width:100-l+"%"})}},a=function(){var a;return f(z),a=y,C&&(f(y),f(K),g(z,y)<10?(i(z),i(y),f(u),p(u),a=u):(p(z),p(y),i(u),a=y)),g(w,z)<5?i(w):C?g(w,a)<5?i(w):p(w):p(w),g(z,t)<5?i(t):C?g(a,t)<5?i(t):p(t):p(t)},bb=function(){$=0,_=0,jb&&(Z(),a(),jb.removeClass("active")),jb=null,kb=null,eb=!1},cb=function(b){if(jb){var d,f,g,i,j;j=n(parseFloat(c.step),parseFloat(c.buffer)),d=b.clientX||b.x,eb?(hb=d-fb,ib=d+gb,R>hb?(ib+=R-hb,hb=R):ib>P&&(hb-=ib-P,ib=P),hb=O(hb),ib=O(ib),$=hb,hb=S+W*hb/100,ib=S+W*ib/100,hb=m(hb,parseFloat(c.precision),parseFloat(c.step),parseFloat(c.floor),parseFloat(c.ceiling)),ib=m(ib,parseFloat(c.precision),parseFloat(c.step),parseFloat(c.floor),parseFloat(c.ceiling)),c[F]=hb,c[E]=ib,$=_=$-X(hb)):(f=d+R-k(e)-h(jb),f=Math.max(Math.min(f,P),R),g=O(f),$=g,i=S+W*g/100,C&&(j>0?i=kb===F?i>parseFloat(c[E])-j?parseFloat(c[E])-j:i:i<parseFloat(c[F])+j?parseFloat(c[F])+j:i:kb===F?i>c[E]&&(kb=E,B.removeClass("active"),A.addClass("active")):i<c[F]&&(kb=F,A.removeClass("active"),B.addClass("active"))),i=m(i,parseFloat(c.precision),parseFloat(c.step),parseFloat(c.floor),parseFloat(c.ceiling)),c[kb]=i,kb===F?$-=X(i):(_=$-X(i),$=0)),Z(),a(),c.$apply()}},db=function(b,d,f){jb=d,kb=f,jb.addClass("active");var g=b.clientX||b.x;kb==G&&(eb=!0,fb=g-Q(c[F])-h(B),gb=Q(c[E])-g+h(A));var i=g+R-k(e);i=Math.max(Math.min(i,P),R);var j=S+W*O(i)/100;j=m(j,parseFloat(c.precision),parseFloat(c.step),parseFloat(c.floor),parseFloat(c.ceiling)),c[kb]=j,Z(),a(),c.$apply(),v()},Y=function(){if(D){var a=function(a,b,c){a=angular.element(a);var e=function(a){db(a,c,b)},f=function(a){cb(a),bb()};window.navigator.pointerEnabled?a.on("pointerdown",e).on("pointermove",cb).on("pointerup",f).on("pointercancel",bb):window.navigator.msPointerEnabled?a.on("MSPointerDown",e).on("MSPointerMove",cb).on("MSPointerUp",f).on("MSPointerCancel",bb):d.bind(a,{start:e,move:cb,end:f,cancel:bb})};a(L,F,B),C&&(a(M,E,A),a(N,G,H))}else{var c=function(a,b,c){a=angular.element(a),c=angular.isUndefined(c)?a:angular.element(c),d.bind(a,{start:function(a){db(a,c,b)}})},e=function(a){a=angular.element(a),d.bind(a,{move:cb,end:function(a){cb(a),bb()},cancel:bb})};c(B,F),c(A,E),c(z,F),c(y,E),c(w,F,B),C?(c(t,E,A),c(H,G),c(K,G,H),c(I,F,B),c(J,E,A)):(c(t,F,B),c(x,F,B)),e(b)}},Z(),a(),s||(Y(),s=!0)},a(V),Y=0,Z=O.length;Z>Y;Y++)X=O[Y],c.$watch(X,V);angular.element(window).bind("resize",V),c.$on("refreshSlider",function(){a(V)})}}}}}]);